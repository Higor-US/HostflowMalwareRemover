/*
 * This file is part of a NickUC project
 *
 * Copyright (c) NickUC <nickuc.com>
 * https://github.com/nickuc
 */

package haizivs.hostflowmalwareremover;

import org.objectweb.asm.tree.AbstractInsnNode;
import org.objectweb.asm.tree.FrameNode;
import org.objectweb.asm.tree.LabelNode;
import org.objectweb.asm.tree.LineNumberNode;

public class AsmUtils {

    public static AbstractInsnNode getNext(AbstractInsnNode node, int amount) {
        for (int i = 0; i < amount; i++) {
            node = getNext(node);
        }
        return node;
    }

    public static AbstractInsnNode getNext(AbstractInsnNode node) {
        AbstractInsnNode next = node.getNext();
        while (!isInstruction(next)) {
            next = next.getNext();
        }
        return next;
    }

    public static boolean isInstruction(AbstractInsnNode node) {
        return !(node instanceof LineNumberNode) && !(node instanceof FrameNode) && !(node instanceof LabelNode);
    }

}
